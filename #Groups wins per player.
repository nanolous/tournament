#Groups wins per player.
select count(*) winner from matches group by winner;
 winner 
--------
      4
      1
      1
      2
(4 rows)

#Groups ID, Name, and Wins.
select * from players LEFT OUTER JOIN matches ON (players.id = matches.winner);
 id |     name      | id | winner | looser 
----+---------------+----+--------+--------
 48 | Welches Riley |  9 |     48 |     49
 50 | Joe Malik     | 10 |     50 |     51
 51 | Mao Tsu-hsi   | 11 |     51 |     52
 52 | Atlanta Hope  | 12 |     52 |     48
 52 | Atlanta Hope  | 13 |     52 |     49
 48 | Welches Riley | 14 |     48 |     52
 48 | Welches Riley | 15 |     48 |     51
 48 | Welches Riley | 16 |     48 |     50
 49 | Markov Chaney |    |        |       

 select matches.winner, count(*) as wins from matches, players where matches.winner = players.id group by matches.winner;
 winner | wins 
--------+------
     48 |    4
     50 |    1
     51 |    1
     52 |    2


select players.id, players.name,count(matches.winner) as wins from players LEFT JOIN matches on players.id  =  matches.winner group by players.id order by wins desc;
 id |     name      | wins 
----+---------------+------
 48 | Welches Riley |    4
 52 | Atlanta Hope  |    2
 50 | Joe Malik     |    1
 51 | Mao Tsu-hsi   |    1
 49 | Markov Chaney |    0
(5 rows)


SELECT players.id, players.name,COUNT(m1.winner) AS wins, COUNT(m2.loser) AS losses, COUNT(DISTINCT m2.loser) + COUNT(m1.winner) AS matches FROM players LEFT JOIN matches as m1 ON players.id = m1.winner LEFT JOIN matches as m2 on players.id = m2.loser GROUP BY players.id ORDER BY wins DESC;
 id  |     name     | wins | matches 
-----+--------------+------+---------
 848 | Bruno Walton |    0 |       0
 849 | Boots ONeal  |    0 |       0
 850 | Cathy Burton |    0 |       0
 851 | Diane Grant  |    0 |       0


standings db schema

Player1 Player2

Add user, then insert to standings as Player1, insert to standings as Player2, next row...

tournament=> SELECT Players.ID FROM Players JOIN Player_Standings ON Players.ID = Player1; 


These queries perform the basic function of adding players to the player_standings table from the players table.
INSERT INTO Player_Standings(player1,player2) SELECT(SELECT ID FROM Players OFFSET 0 LIMIT 1) AS ID1, (SELECT ID FROM Players OFFSET 1 LIMIT 1) AS ID2 FROM Players ORDER BY players.ID DESC;

#Must delete between queries for the desired outcome.

INSERT INTO Player_Standings(player1,player2) SELECT(SELECT ID FROM Players OFFSET 2 LIMIT 1) AS ID1, (SELECT ID FROM Players OFFSET 3 LIMIT 1) AS ID2 FROM Players ORDER BY players.ID DESC;


#Player_Standings populated for match insertion.
INSERT INTO Player_Standings(player1, player2) SELECT p1.ID, p2.ID FROM (SELECT ROW_NUMBER() OVER(ORDER BY ID DESC) AS rownumber, ID FROM Players) as p1 INNER JOIN (SELECT ROW_NUMBER() OVER(ORDER BY ID ASC) AS rownumber, ID FROM Players) as p2 ON p1.rownumber = p2.rownumber;

